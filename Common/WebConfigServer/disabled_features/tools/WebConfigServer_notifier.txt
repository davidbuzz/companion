#env > /tmp/env
# this file should be located here: /etc/dhcp/dhclient-enter-hooks.d/WebConfigServer_notifier
# it creates a file called /tmp/dhclient.wlan0.ip   ( and maybe one for eth0 too, if you use that)
#use sh to run embedded python as it's just easier.
/usr/bin/python - << END
import os
import sys

def file_put_contents(filename,data):
        f = open(filename, 'w')
        f.write(data)
        f.close()

i = os.environ.get('interface')
ip = os.environ.get('new_ip_address')
r = os.environ.get('new_routers')

if (i == None) or (ip == None) or (r == None):
	#print "no action taken, not run by dhclient"
	sys.exit()

out = '#autogenerated by WebConfigServer dhclient hook\ninterface='+i
out = out+'\nnew_ip_address='+ip
out = out+'\nnew_routers='+r
out = out+'\n'

#file_put_contents('/tmp/dhclient.'+i+'.ip',str(os.environ))
file_put_contents('/tmp/dhclient.'+i+'.ip',out)
END
